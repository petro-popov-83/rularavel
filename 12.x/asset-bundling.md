# Компиляция ресурсов (Vite) {#asset-bundling}

## Введение {#introduction}

Начиная с Laravel 9, сборщик Vite стал стандартным инструментом для компиляции JavaScript/TypeScript и стилей. Vite обеспечивает мгновенную быструю сборку и горячую перезагрузку в режиме разработки. По умолчанию исходные файлы приложения находятся в каталоге `resources/js` и `resources/css`, а конфигурация Vite задаётся в файле `vite.config.js`. Для запуска сервера разработки используйте команду `npm run dev` или `bun run dev`, а для сборки в production — `npm run build`.

В шаблонах Blade для подключения собранных файлов используются директивы `@vite(['resources/js/app.js', 'resources/css/app.css'])`. Эти директивы позаботятся о загрузке необходимых скриптов и стилей.

## Обработка статических файлов {#processing-static-assets-with-vite}

Vite автоматически обрабатывает и версионирует файлы, на которые есть ссылки в вашем JavaScript или CSS. Если вам нужно, чтобы Vite обработал изображения или шрифты, которые используются только в Blade‑шаблонах, импортируйте их в главный JS‑файл с помощью конструкции `import.meta.glob()`. Например, чтобы подключить все изображения из `resources/images` и шрифты из `resources/fonts`, добавьте в `resources/js/app.js`:

```js
import.meta.glob([
  '../images/**',
  '../fonts/**',
]);
```

После этого файлы будут обработаны при запуске `npm run build`, а их хешированные URL можно получить в шаблоне через вспомогательный метод `Vite::asset`:

```blade
<img src="{{ Vite::asset('resources/images/logo.png') }}">
```

## Автоматическое обновление при сохранении {#refreshing-on-save}

При разработке Blade‑приложений Vite может автоматически обновлять страницу после изменения файлов. Для этого задайте опцию `refresh: true` в конфигурации Vite:

```js
import { defineConfig } from 'vite';
import laravel from 'laravel-vite-plugin';

export default defineConfig({
    plugins: [
        laravel({
            refresh: true,
        }),
    ],
});
```

В этом режиме при изменении файлов в каталогах `app/Livewire/**`, `app/View/Components/**`, `lang/**`, `resources/lang/**`, `resources/views/**` и `routes/**` браузер будет выполнять полное обновление страницы. При необходимости можно указать собственный список наблюдаемых путей, передав массив директорий в параметр `refresh`. Под капотом используется пакет `vite-plugin-full-reload`, который позволяет тонко настроить поведение перезагрузки, например задав задержку в миллисекундах.

## Псевдонимы и макросы {#aliases-and-macros}

В больших проектах удобно создавать псевдонимы для часто используемых путей. В классе `Vite` можно определить собственные макросы через метод `macro`. Например, чтобы создать удобный метод для получения изображений из каталога `resources/images`, добавьте в метод `boot` вашего `AppServiceProvider`:

```php
use Illuminate\Support\Facades\Vite;

public function boot(): void
{
    Vite::macro('image', fn (string $asset) => Vite::asset("resources/images/{$asset}"));
}
```

Теперь в шаблонах можно использовать `{{ Vite::image('logo.png') }}` для получения версии файла изображения.

## Заключение

Vite предоставляет высокую скорость разработки и гибкие возможности для обработки ваших ресурсов. Используя директивы `@vite`, динамическое подключение статических файлов, автоматическую перезагрузку при сохранении и собственные макросы, вы можете настроить современный процесс сборки фронтенда в проектах на Laravel.