# Шаблоны Blade {#blade-templates}

## Введение {#introduction}

Blade — это простой, но мощный движок шаблонов, который входит в поставку Laravel. В отличие от некоторых PHP‑шаблонизаторов, Blade не запрещает использовать в представлениях обычный PHP. Все Blade‑шаблоны компилируются в обычный PHP код и кэшируются до тех пор, пока не будут изменены, поэтому Blade практически не добавляет накладных расходов при выполнении приложений. Шаблоны Blade имеют расширение `.blade.php` и, как правило, хранятся в каталоге `resources/views`.

Шаблоны можно возвращать из маршрутов или контроллеров с помощью глобального вспомогательного хелпера `view`. Как отмечается в документации по представлениям, данные можно передавать в шаблон вторым аргументом:

```php
Route::get('/', function () {
    return view('greeting', ['name' => 'Finn']);
});
```

## Отображение данных {#displaying-data}

Чтобы вывести данные, переданные в шаблон Blade, заключите имя переменной в двойные фигурные скобки. Например, для маршрута, который передаёт значение переменной `name`, можно вывести его так:

```php
Hello, {{ $name }}.
```

Эти конструкции автоматически пропускаются через функцию PHP `htmlspecialchars`, предотвращая XSS‑атаки. Внутри выражения можно вызывать любые функции PHP, например выводить текущую временную метку:

```php
The current UNIX timestamp is {{ time() }}.
```

### Кодировка HTML {#html-encoding}

По умолчанию Blade и хелпер `e()` дважды кодируют HTML‑сущности. Чтобы отключить двойное кодирование, можно вызвать метод `Blade::withoutDoubleEncoding()` в методе `boot()` вашего `App\Providers\AppServiceProvider`.

### Вывод неэкранированных данных {#displaying-unescaped-data}

Если вы не хотите, чтобы данные экранировались, используйте нотацию с двойными восклицательными знаками:

```php
Hello, {!! $name !!}.
```

Будьте осторожны при выводе данных, полученных от пользователей: обычно следует использовать экранированный синтаксис с двойными фигурными скобками, чтобы избежать XSS‑атак.

### Blade и JavaScript‑фреймворки {#blade-and-javascript-frameworks}

Поскольку многие JavaScript‑фреймворки также используют фигурные скобки для вставки выражений в браузер, можно использовать символ `@`, чтобы Blade оставил выражение нетронутым. Например:

```blade
<h1>Laravel</h1>

Hello, @{{ name }}.
```

В этом примере символ `@` будет удалён Blade, а выражение `{{ name }}` останется необработанным и может быть отрендерено JavaScript‑фреймворком. Символ `@` также можно использовать для экранирования Blade‑директив (например, написать `@@if()` внутри комментария).

### Вывод JSON {#rendering-json}

Иногда нужно передать массив в JavaScript как JSON. Вместо вызова `json_encode` в PHP можно использовать метод `Illuminate\Support\Js::from`, который правильно экранирует данные и генерирует корректный вызов `JSON.parse`:

```blade
<script>
    var app = {{ Illuminate\Support\Js::from($array) }};
</script>
```

Этот метод гарантирует, что объект или массив безопасно преобразуется в JavaScript‑объект.

## Заключение

Blade — гибкий и мощный механизм шаблонов. Он позволяет строить представления, используя привычный PHP, обеспечивает автоматическое экранирование переменных для безопасности и предоставляет удобные инструменты для интеграции с JavaScript‑фреймворками и вывода данных в различных форматах.