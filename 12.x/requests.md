# HTTP‑запросы {#http-requests}

- [Введение](#introduction)
- [Взаимодействие с запросом](#interacting-with-the-request)
  - [Получение экземпляра запроса](#accessing-the-request)
  - [Путь, хост и метод](#request-path-host-and-method)
  - [URL и строки запроса](#request-url)
  - [Заголовки, IP и User‑Agent](#headers-ip-and-user-agent)
  - [Cookies и файлы](#cookies-and-files)
- [Работа с входными данными](#working-with-input)
  - [Получение данных](#retrieving-input)
  - [Массивы и вложенные данные](#arrays-and-nested-input)
  - [Типизированные и проверенные значения](#typed-and-validated-values)
  - [Старые данные формы](#old-input)

## Введение {#introduction}

Класс `Illuminate\Http\Request` предоставляет объектно‑ориентированный способ
работы с текущим HTTP‑запросом. Через него можно получить доступ к
переданным данным формы, файлам, cookie, заголовкам и другой информации
о запросе.

## Взаимодействие с запросом {#interacting-with-the-request}

### Получение экземпляра запроса {#accessing-the-request}

Laravel автоматически внедряет объект запроса в ваши маршруты и методы
контроллеров. Просто объявите параметр типа `Illuminate\Http\Request` —
сервисный контейнер передаст текущий запрос. То же
самое работает в замыканиях маршрутов:

```php
use Illuminate\Http\Request;

Route::get('/', function (Request $request) {
    // взаимодействие с запросом
});
```

При наличии параметров маршрута их следует указывать после запроса в
сигнатуре метода.

### Путь, хост и метод {#request-path-host-and-method}

Класс `Request` содержит множество методов для анализа входящего запроса. Например:

- `path()` возвращает путь запроса (`foo/bar`).
- `is('admin/*')` проверяет, соответствует ли путь определённому шаблону с
  подстановкой `*`.
- `routeIs('admin.*')` определяет, соответствует ли запрос маршруту с
  определённым именем.
- `method()` возвращает HTTP‑метод (GET, POST и т. д.), а `isMethod('post')`
  позволяет проверить метод.

### URL и строки запроса {#request-url}

Метод `url()` возвращает базовый URL без строки запроса, а
`fullUrl()` — полный URL с параметрами. Для
добавления параметров к текущему URL используйте `fullUrlWithQuery(array $query)`.

### Заголовки, IP и User‑Agent {#headers-ip-and-user-agent}

Получить заголовок можно через `header('X-Header')`. Метод
`ip()` возвращает IP‑адрес клиента, `userAgent()` — строку User‑Agent.

### Cookies и файлы {#cookies-and-files}

Для доступа к cookie используйте `cookie('name')`. Чтобы добавить cookie
к ответу, воспользуйтесь фасадом `Cookie`. Загруженные файлы доступны через
метод `file('photo')`, который возвращает экземпляр `UploadedFile`.

## Работа с входными данными {#working-with-input}

### Получение данных {#retrieving-input}

Метод `input()` возвращает значение параметра формы или строки запроса.
С помощью `query()` можно обратиться только к параметрам строки запроса, а
`post()` — только к данным формы. Для чтения JSON‑запросов используйте
`$request->json()` или метод `json('key')`.

Чтобы получить только некоторый набор значений, применяйте `only([...])`. Метод
`except([...])` исключает перечисленные ключи из результата. Функция
`all()` возвращает все входные данные.

### Массивы и вложенные данные {#arrays-and-nested-input}

Laravel поддерживает доступ к значениям вложенных массивов с помощью точечной
нотации: `$request->input('products.0.name')`. Вы можете также получить
массива целиком через `input('products')`.

### Типизированные и проверенные значения {#typed-and-validated-values}

Помимо базовых методов, `Request` предоставляет методы для получения данных
определённого типа: `boolean('active')`, `integer('age')`, `float('price')`,
`date('published_at')`, `string('name')` и т. д. Laravel попытается привести
значение к указанному типу. Для получения коллекции значений используйте
`collect()`.

### Старые данные формы {#old-input}

После перенаправления (например, после валидации) Laravel автоматически
сохраняет входные данные в сессию. Директива Blade `@old('name')` или
функция `old('name')` позволяют снова отобразить введённые значения в формах.

Более подробные разделы, такие как доверенные прокси, обработка заголовков
`X-Forwarded-*`, доступ к файлам, cookie и анализ JSON‑данных, можно найти в
оригинальной документации. Они пригодятся для более сложных сценариев работы
с HTTP‑запросами.